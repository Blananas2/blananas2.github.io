<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Knob — Keep Talking and Nobody Explodes</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/Modules/Knob.css">
    <script src="js/ktane-utils.js"></script>
    <script src='js/ruleseed.js'></script>
    <script>
        const litSvg = "<svg width=\"16\" height=\"16\" version=\"1.1\" viewBox=\"0 0 8.47 8.47\" xmlns=\"http://www.w3.org/2000/svg\"> <circle cx=\"4.23\" cy=\"4.23\" r=\"3.79\" fill=\"#fff\" stroke=\"#000\" stroke-miterlimit=\"5\" stroke-width=\".894\"/></svg>";
        const unlitSvg = "<svg width=\"16\" height=\"16\" version=\"1.1\" viewBox=\"0 0 8.47 8.47\" xmlns=\"http://www.w3.org/2000/svg\"> <circle cx=\"4.23\" cy=\"4.23\" r=\"3.79\" fill=\"#000\" stroke=\"#000\" stroke-miterlimit=\"5\" stroke-width=\".894\"/></svg>";

        function setRules(rnd)
        {
            var initial = [];
            for (var i = 0; i < (1 << 6); i++)
                initial.push(i);
            var list = [];
            do
            {
                var num = pickRandomAndRemove(rnd, initial);
                var num2 = pickRandomAndRemove(rnd, initial);
                var num3 = pickRandomAndRemove(rnd, initial);

                var a = num << 6 | num2;
                var a2 = num << 6 | num3;

                var num4 = pickRandomAndRemove(rnd, initial);
                var num5 = pickRandomAndRemove(rnd, initial);
                var num6 = pickRandomAndRemove(rnd, initial);

                var a3 = num5 << 6 | num4;
                var a4 = num6 << 6 | num4;

                list.push(intToBoolArray(a, 12));
                list.push(intToBoolArray(a2, 12));
                list.push(intToBoolArray(a3, 12));
                list.push(intToBoolArray(a4, 12));
            }
            while (list.length < 8);

            var rules = [];
            for (var i = 0; i < 8; i++)
                rules.push(pickRandomAndRemove(rnd, list));

            Array.from(document.getElementsByClassName('knob-rule-table')).forEach((x, ruleIx) =>
                Array.from(x.getElementsByTagName('td')).forEach((y, ledIx) =>
                    y.innerHTML = rules[ruleIx][ledIx] ? litSvg : unlitSvg));
        }

        function setDefaultRules(rnd) { setRules(rnd); }

        function pickRandomAndRemove(rnd, list)
        {
            var ix = rnd.next(0, list.length);
            var item = list[ix];
            list.splice(ix, 1);
            return item;
        }

        function intToBoolArray(a, arraySize)
        {
            var array = [];
            for (var i = 0; i < arraySize; i++)
            {
                array.push((a & 1) == 1);
                a >>= 1;
            }
            return array;
        }
    </script>
    <style>
        table {
            margin-right: .5cm;
        }

        td {
            width: .2cm;
            height: .2cm;
            text-align: center;
            font-size: 20px;
        }

        .knob-rule-table {
            display: inline-table;
            margin-bottom: 1em;
        }

        .knob-tl, .knob-tm, .knob-tr { border-top-width: 3px; }
        .knob-tr, .knob-br { border-right-width: 3px; }
        .knob-bl, .knob-bm, .knob-br { border-bottom-width: 3px; }
        .knob-tl, .knob-bl { border-left-width: 3px; }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes</span>
                <span class="page-header-section-title">Knob</span>
            </div>
            <div class="page-footer absolute-footer"></div>
            <div class="page-content">
                <img src="img/Component/Knob.svg" class="diagram">
                <h2>On the Subject of Knob</h2>
                <p class="flavour-text">Needlessly complicated and endlessly needy. Imagine if such expertise were used to make something other than diabolical puzzles.</p>
                <ul>
                    <li>The knob can be turned to one of four different positions.</li>
                    <li>The knob must be in the correct position when this module’s timer hits zero.</li>
                    <li>The correct position can be determined by the on/off configuration of the twelve LEDs.</li>
                    <li>Knob positions are relative to the “UP” label, which may have rotated.</li>
                </ul>
                <h3>LED Configurations</h3>
                <p>
                    <svg width="16" height="16" version="1.1" viewBox="0 0 8.47 8.47" xmlns="http://www.w3.org/2000/svg"> <circle cx="4.23" cy="4.23" r="3.79" fill="#fff" stroke="#000" stroke-miterlimit="5" stroke-width=".894"/></svg> = Lit LED, 
                    <svg width="16" height="16" version="1.1" viewBox="0 0 8.47 8.47" xmlns="http://www.w3.org/2000/svg"> <circle cx="4.23" cy="4.23" r="3.79" fill="#000" stroke="#000" stroke-miterlimit="5" stroke-width=".894"/></svg> = Unlit LED</p>
                <h4>Up Position:</h4>
                <table class='knob-rule-table'>
                    <tr>
                        <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td> <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td>
                    </tr>
                    <tr>
                        <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td> <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td>
                    </tr>
                </table>
                <table class='knob-rule-table'>
                    <tr>
                        <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td> <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td>
                    </tr>
                    <tr>
                        <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td> <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td>
                    </tr>
                </table>
                <h4>Down Position:</h4>
                <table class='knob-rule-table'>
                    <tr>
                        <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td> <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td>
                    </tr>
                    <tr>
                        <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td> <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td>
                    </tr>
                </table>
                <table class='knob-rule-table'>
                    <tr>
                        <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td> <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td>
                    </tr>
                    <tr>
                        <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td> <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td>
                    </tr>
                </table>
                <h4>Left Position:</h4>
                <table class='knob-rule-table'>
                    <tr>
                        <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td> <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td>
                    </tr>
                    <tr>
                        <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td> <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td>
                    </tr>
                </table>
                <table class='knob-rule-table'>
                    <tr>
                        <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td> <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td>
                    </tr>
                    <tr>
                        <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td> <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td>
                    </tr>
                </table>
                <h4>Right Position:</h4>
                <table class='knob-rule-table'>
                    <tr>
                        <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td> <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td>
                    </tr>
                    <tr>
                        <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td> <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td>
                    </tr>
                </table>
                <table class='knob-rule-table'>
                    <tr>
                        <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td> <td class="knob-tl"></td><td class="knob-tm"></td><td class="knob-tr"></td>
                    </tr>
                    <tr>
                        <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td> <td class="knob-bl"></td><td class="knob-bm"></td><td class="knob-br"></td>
                    </tr>
                </table>
            </div>
            <div class="page-footer relative-footer">Page 41 of 47</div>
        </div>
    </div>
</body>
</html>
